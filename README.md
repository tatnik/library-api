# Library API

**RESTful API –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –±–∏–±–ª–∏–æ—Ç–µ—á–Ω—ã–º –∫–∞—Ç–∞–ª–æ–≥–æ–º**

---

## üéØ –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –∑–∞–ø—É—Å–∫—É

1. **–ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è**

   ```bash
   git clone https://github.com/tatnik/library-api
   cd library-api
   ```

2. **–°–æ–∑–¥–∞–Ω–∏–µ `.env`** (–≤ –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞):

   ```dotenv
   POSTGRES_USER=postgres
   POSTGRES_PASSWORD=postgres
   POSTGRES_DB=library_db
   DATABASE_URL=postgresql+psycopg2://postgres:postgres@db:5432/library_db
   SECRET_KEY=your_super_secret_key
   ACCESS_TOKEN_EXPIRE_MINUTES=30
   ```
3. **–°–æ–∑–¥–∞–Ω–∏–µ –ø–∞–ø–æ–∫ –¥–ª—è —Å–ª—É–∂–µ–±–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö**

   ```bash
   mkdir data
   cd data
   mkdir postgres       # —Ç–æ–º –¥–ª—è Postgres –Ω–∞ —Ö–æ—Å—Ç–µ
   mkdir tests          # –ø–∞–ø–∫–∞ –¥–ª—è –ª–æ–∫–∞–ª—å–Ω—ã—Ö –∫–æ–ø–∏–π –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö, –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö –¥–ª—è —Ç–µ—Å—Ç–æ–≤
   ```


4. **–ó–∞–ø—É—Å–∫ —á–µ—Ä–µ–∑ Docker Compose**

   ```bash
 
   docker-compose up -d --build
   ```

5. **–ü–µ—Ä–≤–∏—á–Ω–∞—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è**

   * –û—Ç–∫—Ä–æ–π—Ç–µ `http://localhost:8000/docs`
   * –í —Ä–∞–∑–¥–µ–ª–µ **Auth** –≤—ã–ø–æ–ª–Ω–∏—Ç–µ `POST /auth/register` —Å JSON:

     ```json
     {"email": "admin@example.com", "password": "strongpass"}
     ```
   * –î–∞–ª–µ–µ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ `POST /auth/login` (form-data) –∏ –ø–æ–ª—É—á–∏—Ç–µ `access_token`.

---

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
library-api/
‚îú‚îÄ‚îÄ .env               
‚îú‚îÄ‚îÄ .gitignore
‚îú‚îÄ‚îÄ alembic.ini
‚îú‚îÄ‚îÄ docker-compose.yml
‚îú‚îÄ‚îÄ dockerfile
‚îú‚îÄ‚îÄ pytest.ini
‚îú‚îÄ‚îÄ README.md
‚îú‚îÄ‚îÄ requirements.txt

‚îú‚îÄ‚îÄ alembic/
‚îÇ   ‚îú‚îÄ‚îÄ env.py
‚îÇ   ‚îú‚îÄ‚îÄ script.py.mako
‚îÇ   ‚îî‚îÄ‚îÄ versions/
‚îú‚îÄ‚îÄ app/
‚îÇ   ‚îú‚îÄ‚îÄ main.py           # —Ç–æ—á–∫–∞ –≤—Ö–æ–¥–∞ FastAPI
‚îÇ   ‚îú‚îÄ‚îÄ db.py             # SQLAlchemy engine, Session, Base, get_db
‚îÇ   ‚îú‚îÄ‚îÄ models.py         # ORM-–º–æ–¥–µ–ª–∏: User, Book, Reader, BorrowedBook
‚îÇ   ‚îú‚îÄ‚îÄ schemas.py        # Pydantic-—Å—Ö–µ–º—ã
‚îÇ   ‚îú‚îÄ‚îÄ security.py       # JWT, –ø–∞—Ä–æ–ª–∏, deps
‚îÇ   ‚îú‚îÄ‚îÄ core/config.py    # Pydantic Settings
‚îÇ   ‚îî‚îÄ‚îÄ routers/
‚îÇ       ‚îú‚îÄ‚îÄ auth.py       # —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è, –ª–æ–≥–∏–Ω, logout, me
‚îÇ       ‚îú‚îÄ‚îÄ books.py      # CRUD –∫–Ω–∏–≥ + –ø—É–±–ª–∏—á–Ω—ã–µ GET + —Å–ø–∏—Å–æ–∫ –Ω–µ–≤–æ–∑–≤—Ä–∞—â–µ–Ω–Ω—ã—Ö —á–∏—Ç–∞—Ç–µ–ª–µ–º –∫–Ω–∏–≥
‚îÇ       ‚îú‚îÄ‚îÄ readers.py    # CRUD —á–∏—Ç–∞—Ç–µ–ª–µ–π
‚îÇ       ‚îî‚îÄ‚îÄ borrow.py     # –≤—ã–¥–∞—á–∞ –∏ –≤–æ–∑–≤—Ä–∞—Ç –∫–Ω–∏–≥ + —Å–ø–∏—Å–æ–∫ –Ω–µ–≤–æ–∑–≤—Ä–∞—â–µ–Ω–Ω—ã—Ö —á–∏—Ç–∞—Ç–µ–ª–µ–º –∫–Ω–∏–≥
‚îú‚îÄ‚îÄ data/
‚îÇ   ‚îú‚îÄ‚îÄ postgres
‚îÇ   ‚îî‚îÄ‚îÄ tests
‚îî‚îÄ‚îÄ tests/
    ‚îú‚îÄ‚îÄ test_auth.py
    ‚îú‚îÄ‚îÄ test_books.py
    ‚îú‚îÄ‚îÄ test_borrow.py
    ‚îú‚îÄ‚îÄ test_db_shema.py
    ‚îî‚îÄ‚îÄ test_readers.py
```

---

## üóÑÔ∏è –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

* **users**: —Ö—Ä–∞–Ω–∏—Ç –±–∏–±–ª–∏–æ—Ç–µ–∫–∞—Ä–µ–π (`email`, `hashed_password`, `is_active`).
* **books**: –∫–∞—Ç–∞–ª–æ–≥ –∫–Ω–∏–≥ (`title`, `author`, `published_year`, `isbn`, `copies`, `description`).
* **readers**: —á–∏—Ç–∞—Ç–µ–ª–∏ (`name`, `email`, `phone`).
* **borrowed_books**: –∏—Å—Ç–æ—Ä–∏—è –≤—ã–¥–∞—á–∏ –∫–Ω–∏–≥ (`book_id`, `reader_id`, `borrow_date`, `return_date`).
* **alembic\_version**: —Å–ª—É–∂–µ–±–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ –º–∏–≥—Ä–∞—Ü–∏–π.

**–†–µ—à–µ–Ω–∏—è**:

* –û—Ç–¥–µ–ª—å–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ `borrowed_books` –¥–ª—è —É—á—ë—Ç–∞ –≤—ã–¥–∞—á–∏/–≤–æ–∑–≤—Ä–∞—Ç–∞ –∫–Ω–∏–≥, —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π –ø–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤—É –≤—ã–¥–∞–≤–∞–µ–º—ã—Ö –∫–Ω–∏–≥, —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏—è —Å–ø–∏—Å–∫–∞ –Ω–µ–≤–æ–∑–≤—Ä–∞—â–µ–Ω–Ω—ã—Ö –∫–Ω–∏–≥.
* –ò–Ω–¥–µ–∫—Å—ã –ø–æ `id`, `email` –∏ `isbn` –¥–ª—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏.

---

## ‚öôÔ∏è –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞

1. **–í—ã–¥–∞—á–∞ –∫–Ω–∏–≥–∏** (`POST /borrow/`)

   * –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –∫–Ω–∏–≥–∞ –µ—Å—Ç—å –≤ –Ω–∞–ª–∏—á–∏–∏ (–≤ —Ç–∞–±–ª–∏—Ü–µ **books** –¥–ª—è –≤—ã–±—Ä–∞–Ω–Ω–æ–π –∫–Ω–∏–≥–∏ `copies > 0`). –ï—Å–ª–∏ –∫–Ω–∏–≥–∏ –≤ –Ω–∞–ª–∏—á–∏–∏ –Ω–µ—Ç,  –≤–æ–∑–≤—Ä–∞—â–∞–µ–º ‚Äî `400 Bad Request`.
   * –£–º–µ–Ω—å—à–∞–µ–º `copies` –Ω–∞ 1 –∏ —Å–æ–∑–¥–∞—ë–º –∑–∞–ø–∏—Å—å –≤ **borrowed_books** —Å `return_date = NULL`.

2. **–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –≤—ã–¥–∞—á–∏**

   * –û–¥–∏–Ω —á–∏—Ç–∞—Ç–µ–ª—å –Ω–µ –º–æ–∂–µ—Ç –∏–º–µ—Ç—å –±–æ–ª–µ–µ **3** –≤—ã–¥–∞–Ω–Ω—ã—Ö –∫–Ω–∏–≥ (—Å—á–∏—Ç–∞–µ–º  –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø–∏—Å–µ–π –≤ —Ç–∞–±–ª–∏—Ü–µ **borrowed_books**  –ø–æ `reader_id`, –¥–ª—è –∫–æ—Ç–æ—Ä—ã—Ö `return_date IS NULL`).

3. **–í–æ–∑–≤—Ä–∞—Ç –∫–Ω–∏–≥–∏** (`POST /return/`)

   * –í —Ç–∞–±–ª–∏—Ü–µ **borrowed_books** –∏—â–µ–º –∑–∞–ø–∏—Å—å —Å `book_id`, `reader_id` –∏ `return_date IS NULL`.
   * –ï—Å–ª–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞ ‚Äî `400 Bad Request`.
   * –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º `return_date = now()`,
   * –í —Ç–∞–±–ª–∏—Ü–µ **books** –¥–ª—è –∑–∞–ø–∏—Å–∏ —Å `id = book_id` —É–≤–µ–ª–∏—á–∏–≤–∞–µ–º `copies` –Ω–∞ 1.

**–°–ª–æ–∂–Ω–æ—Å—Ç–∏**:

* –ö–æ–Ω–∫—É—Ä–µ–Ω—Ç–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã —É–≤–µ–ª–∏—á–∏–≤–∞—é—Ç —Å–ª–æ–∂–Ω–æ—Å—Ç—å –∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç–∏ `copies` ‚Äî —Ä–µ—à–∞–µ—Ç—Å—è –∑–∞ —Å—á—ë—Ç —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π –∏ –±–ª–æ–∫–∏—Ä–æ–≤–æ–∫.
* –ü–æ–¥—Å—á—ë—Ç –≤—ã–¥–∞–Ω–Ω—ã—Ö –∫–Ω–∏–≥ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω —á–µ—Ä–µ–∑ `COUNT` –≤ SQLAlchemy.

---

## üîí –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è

* **JWT** —á–µ—Ä–µ–∑ `python-jose[cryptography]`.
* **–•–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–∞—Ä–æ–ª–µ–π** —Å `passlib[bcrypt]`.
* **Dependencies**:

  * `get_db()` –∏–∑ `app/db.py`.
  * `get_current_user` –ø—Ä–æ–≤–µ—Ä—è–µ—Ç JWT (`sub` ‚Üí `email`) –∏ —á—ë—Ä–Ω—ã–π —Å–ø–∏—Å–æ–∫ –æ—Ç–æ–∑–≤–∞–Ω–Ω—ã—Ö —Ç–æ–∫–µ–Ω–æ–≤.
* **–ó–∞—â–∏—â–µ–Ω—ã JWT**:

  * –°–æ–∑–¥–∞–Ω–∏–µ, –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏ —É–¥–∞–ª–µ–Ω–∏–µ (–∫–Ω–∏–≥, —á–∏—Ç–∞—Ç–µ–ª–µ–π).
  * –≠–Ω–¥–ø–æ–π–Ω—Ç—ã –≤—ã–¥–∞—á–∏/–≤–æ–∑–≤—Ä–∞—Ç–∞ –∫–Ω–∏–≥.
  * `/readers`, `/borrow`.
* **–ü—É–±–ª–∏—á–Ω—ã–µ**:

  * –ß—Ç–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –∏ –¥–µ—Ç–∞–ª–µ–π –∫–Ω–∏–≥ (`GET /books/`, `GET /books/{id}`)  ‚Äî —É–¥–æ–±–Ω–æ –¥–ª—è –∫–∞—Ç–∞–ª–æ–≥–∞

---

## üí° –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è —Ñ–∏—á–∞: —Ä–µ–∑–µ—Ä–≤–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–Ω–∏–≥

–ü—Ä–µ–¥–ª–∞–≥–∞–µ—Ç—Å—è —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –º–µ—Ö–∞–Ω–∏–∑–º —Ä–µ–∑–µ—Ä–≤–∏—Ä–æ–≤–∞–Ω–∏—è –∫–Ω–∏–≥ :

* **–ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å—Ä–æ–∫–æ–≤ —Ä–µ–∑–µ—Ä–≤–∏—Ä–æ–≤–∞–Ω–∏—è**:

  * –ü–∞—Ä–∞–º–µ—Ç—Ä `RESERVATION_RESERVED_DAYS` –≤ `app/core/config.py` –∑–∞–¥–∞—ë—Ç –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —Å—Ä–æ–∫ (–≤ –¥–Ω—è—Ö) —Ö—Ä–∞–Ω–µ–Ω–∏—è —Ä–µ–∑–µ—Ä–≤–∞.

* **–ú–æ–¥–µ–ª—å –¥–∞–Ω–Ω—ã—Ö `reservations` **:

  * `id`: PK
  * `reader_id`: FK ‚Üí `readers.id`
  * `book_id`: FK ‚Üí `books.id`
  * `start_date`: –¥–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞–ø–∏—Å–∏ (—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ—Ç —Ñ–∞–∫—Ç –∂–µ–ª–∞–µ–Ω–∏—è —á–∏—Ç–∞—Ç–µ–ª—è –ø–æ–ª—É—á–∏—Ç—å –∫–Ω–∏–≥—É)
  * `reserve_date`: –¥–∞—Ç–∞ —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–æ–≥–æ —Ä–µ–∑–µ—Ä–≤–∏—Ä–æ–≤–∞–Ω–∏—è (—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ—Ç —Ñ–∞–∫—Ç –≤–æ–∑–≤—Ä–∞—Ç–∞ –≤ –±–∏–±–ª–∏–æ—Ç–µ–∫—É –∫–Ω–∏–≥–∏ –¥—Ä—É–≥–∏–º —á–∏—Ç–∞—Ç–µ–ª–µ–º –∏ –ø–µ—Ä–µ–º–µ—â–µ–Ω–∏–µ –µ–µ –≤ —Ä–µ–∑–µ—Ä–≤)
  * `expire_date`: `reserve_date + RESERVATION_RESERVED_DAYS` (–¥–æ –∫–∞–∫–æ–π –¥–∞—Ç—ã –∫–Ω–∏–≥–∞ –º–æ–∂–µ—Ç –æ—Å—Ç–∞–≤–∞—Ç—å—Å—è –≤ —Ä–µ–∑–µ—Ä–≤–µ)
  * `notify_date`: –¥–∞—Ç–∞/–≤—Ä–µ–º—è –æ—Ç–ø—Ä–∞–≤–∫–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è —á–∏—Ç–∞—Ç–µ–ª—é (NULL –¥–æ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è)
  * `status`: ENUM(`PENDING`,`RESERVED`. `NOTIFIED`, `COMPLETED`, `CANCELLED`, `EXPIRED`)

* **–ü–æ—Ç–æ–∫ —Ä–∞–±–æ—Ç—ã**:

  1. **–°–æ–∑–¥–∞–Ω–∏–µ wish-–∑–∞–ø–∏—Å–∏**: –¥–ª—è –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–µ–π –≤ –Ω–∞–ª–∏—á–∏–∏ –∫–Ω–∏–≥–∏ (`copies == 0`)  –≤ —Ç–∞–±–ª–∏—Ü–µ `reservations` —Å–æ–∑–¥–∞—ë–º –∑–∞–ø–∏—Å—å —Å–æ —Å—Ç–∞—Ç—É—Å–æ–º `PENDING` –∏ `start_date` = —Ç–µ–∫—É—â–∞—è –¥–∞—Ç–∞
  2. **–í–æ–∑–≤—Ä–∞—Ç –∫–Ω–∏–≥–∏** : –ø—Ä–∏ –≤–æ–∑–≤—Ä–∞—Ç–µ –ø—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ –∞–∫—Ç–∏–≤–Ω—ã—Ö —Ä–µ–∑–µ—Ä–≤–æ–≤ –≤ —Å—Ç–∞—Ç—É—Å–µ `PENDING`, –±–µ—Ä—ë–º —Å–∞–º—ã–π —Å—Ç–∞—Ä—ã–π, –∏–∑–º–µ–Ω—è–µ–º `reserve_date` –Ω–∞  —Ç–µ–∫—É—â—É—é –¥–∞—Ç—É. –ò–∑–º–µ–Ω—è–µ–º —Å—Ç–∞—Ç—É—Å –Ω–∞ `RESERVED`. –ó–Ω–∞—á–µ–Ω–∏–µ `copies` –≤ —Ç–∞–±–ª–∏—Ü–µ `books` –Ω–µ –∏–∑–º–µ–Ω—è–µ–º. 
  3. **–£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ —á–∏—Ç–∞—Ç–µ–ª–µ–π** : –º–æ–∂–µ—Ç –≤—ã–ø–æ–ª–Ω—è—Ç—å—Å—è –ø–æ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—é. –ò–∑ —Ç–∞–±–ª–∏—Ü—ã `reservations` –≤—ã–±–∏—Ä–∞—é—Ç—Å—è –≤—Å–µ –∑–∞–ø–∏—Å–∏ —Å–æ —Å—Ç–∞—Ç—É—Å–æ–º `RESERVED`. –î–ª—è –∫–∞–∂–¥–æ–π –∑–∞–ø–∏—Å–∏ –≤ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –ø–æ SMS –∏–ª–∏ email, –≤ —Å–ª—É—á–∞–µ —É—Å–ø–µ—à–Ω–æ–π –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å—Ç–∞—Ç—É—Å –º–µ–Ω—è–µ—Ç—Å—è –Ω–∞ `NOTIFIED`, –∑–∞–ø–æ–ª–Ω—è–µ—Ç—Å—è `notify_date`.
  4. **–í—ã–¥–∞—á–∞ –∫–Ω–∏–≥–∏ –∏–∑ —Ä–µ–∑–µ—Ä–≤–∞**: —Å—Ç–∞—Ç—É—Å ‚Üí `COMPLETED`, —Å–æ–∑–¥–∞—ë–º –∑–∞–ø–∏—Å—å –≤—ã–¥–∞—á–∏ (`borrowed_books`), `copies` –ø—Ä–∏ —ç—Ç–æ–º –Ω–µ –¥–æ–∂–Ω–æ –∏–∑–º–µ–Ω—è—Ç—å—Å—è (–º–æ–∂–Ω–æ –≤ —Ç–∞–±–ª–∏—Ü—É –≤—ã–¥–∞—á –¥–æ–±–∞–≤–∏—Ç—å –ø–æ–ª–µ —Å –ø–æ–º–µ—Ç–∫–æ–π, —á—Ç–æ –≤—ã–¥–∞—á–∞ –∏–¥–µ—Ç –∏–∑ —Ä–µ–∑–µ—Ä–≤–∞).
  5. **–û—Ç–∫–∞–∑ —á–∏—Ç–∞—Ç–µ–ª—è –æ—Ç –ø–æ–ª—É—á–µ–Ω–∏—è –∫–Ω–∏–≥–∏**:  —Å—Ç–∞—Ç—É—Å ‚Üí `CANCELLED`, –≤ `books` **—É–≤–µ–ª–∏—á–∏–≤–∞–µ–º** `copies` –Ω–∞ 1 (—Ä–µ–∑–µ—Ä–≤ —Å–Ω–∏–º–∞–µ—Ç—Å—è).
  6. **–ò—Å—Ç–µ—á–µ–Ω–∏–µ —Å—Ä–æ–∫–∞ —Ä–µ–∑–µ—Ä–≤–∞**: 
     * –ü–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∞—è –∑–∞–¥–∞—á–∞ (Celery/cron) –ø—Ä–æ–≤–µ—Ä—è–µ—Ç —Ä–µ–∑–µ—Ä–≤—ã —Å `expire_date < now()` –≤ —Å—Ç–∞—Ç—É—Å–µ `RESERVED` –∏–ª–∏ `NOTIFIED`, –ø–µ—Ä–µ–≤–æ–¥–∏—Ç –∏—Ö –≤ `EXPIRED` –∏ **—É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç** `copies` –Ω–∞ 1 –≤ —Ç–∞–±–ª–∏—Ü–µ `books`.

* **–≠–Ω–¥–ø–æ–∏–Ω—Ç—ã**:

  * `POST`  /reservations/add/{id_book}{id_reader}  –¥–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—É—é –∑–∞–ø–∏—Å—å
  * `PUT`   /reservations/add/{id} –∏–∑–º–µ–Ω–∏—Ç—å –∑–∞–ø–∏—Å—å
  * `GET`   /reservations/{reader_id}{[—Å–ø–∏—Å–æ–∫ —Å—Ç–∞—Ç—É—Å–æ–≤]}` ‚Äî –ø–æ–ª—É—á–∏—Ç—å –≤—Å–µ –∑–∞–ø–∏—Å–∏ —á–∏—Ç–∞—Ç–µ–ª—è –¥–ª—è –∫–æ—Ç–æ—Ä—ã—Ö `status` –≤ —É–∫–∞–∑–∞–Ω–Ω–æ–º —Å–ø–∏—Å–∫–µ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é —Å–ø–∏—Å–æ–∫ = [RESERVED, NOTIFIED])
  * `PATCH  /reservations/notifyall/` ‚Äî –æ—Ç–ø—Ä–∞–≤–∏—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –≤—Å–µ–º (`status`=`RESERVED`)
  * `PATCH  /reservations/{id}/notify` ‚Äî –≤—Ä—É—á–Ω—É—é –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –ø–æ–≤—Ç–æ—Ä–Ω–æ–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ (—Å–º—Å/email)
  * `PATCH  /reservations/{id}/complete` ‚Äî –æ—Ñ–æ—Ä–º–∏—Ç—å –≤—ã–¥–∞—á—É –ø–æ—Å–ª–µ –ø—Ä–∏—Ö–æ–¥–∞ —á–∏—Ç–∞—Ç–µ–ª—è
  * `PATCH  /reservations/{id}/cancel` ‚Äî –æ—Ç–º–µ–Ω–∏—Ç—å —Ä–µ–∑–µ—Ä–≤ (—á–∏—Ç–∞—Ç–µ–ª—å –æ—Ç–∫–∞–∑–∞–ª—Å—è)
  * `PATCH  /reservations/expiring` ‚Äî –ø–æ–ª—É—á–∏—Ç—å –≤—Å–µ –∑–∞–ø–∏—Å–∏ —Å –∏—Å—Ç–µ–∫–∞—é—â–∏–º —Å—Ä–æ–∫–æ–º —Ä–µ–∑–µ—Ä–≤–∞
**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞**:

* –ß—ë—Ç–∫–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ —Ä–µ–∑–µ—Ä–≤–∞ (`status`), —Ñ–∏–∫—Å–∞—Ü–∏—è –¥–∞—Ç—ã —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è, –≤—Ä–µ–º–µ–Ω–∏ –∏—Å—Ç–µ—á–µ–Ω–∏—è.
* –ì–∏–±–∫–æ—Å—Ç—å: –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è (–ø–æ–≤—Ç–æ—Ä–Ω—ã–µ SMS) —á–µ—Ä–µ–∑ –∑–∞–¥–∞—á—É `notify_pending_reservations`.
* –ö–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –∫–æ–ø–∏–π –±–ª–∞–≥–æ–¥–∞—Ä—è —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–π –ª–æ–≥–∏–∫–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ CRUD –∏ —Ñ–æ–Ω–æ–≤—ã—Ö –∑–∞–¥–∞—á–∞—Ö.

*–ò–¥–µ—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏*: –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Celery –∏–ª–∏ APScheduler –¥–ª—è —Ñ–æ–Ω–æ–≤—ã—Ö –∑–∞–¥–∞—á: –æ—Ç–ø—Ä–∞–≤–∫–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –∏ –∑–∞–∫—Ä—ã—Ç–∏—è –ø—Ä–æ—Å—Ä–æ—á–µ–Ω–Ω—ã—Ö —Ä–µ–∑–µ—Ä–≤–æ–≤.
–¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –≤—ã–ø–æ–ª–Ω—è—Ç—å –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫—É—é –æ—á–∏—Å—Ç–∫—É —Ç–∞–±–ª–∏—Ü—ã –æ—Ç —Å—Ç–∞—Ä—ã—Ö –∑–∞–ø–∏—Å–µ–π —Å –∑–∞–∫—Ä—ã—Ç—ã–º–∏ —Ä–µ–∑–µ—Ä–≤–∞–º–∏
